// Orion - Local Storage
(function () {
    "use strict";

    var extTitle = "Orion - localStorage";
    var log = function (c, b) { if ("object" === typeof console && "function" === typeof console.error && "function" === typeof console.info && "function" === typeof console.warn) { var a; "object" === typeof c ? (c.unshift("[" + extTitle + "]\n"), a = c) : a = ["[" + extTitle + "]\n" + c]; if ("undefined" === typeof b || "alerta" !== b.toLowerCase() && "aviso" !== b.toLowerCase()) if ("undefined" !== typeof b && "info" === b.toLowerCase()) try { console.info.apply(console, a) } catch (d) { console.info(a.join("\n")) } else try { console.error.apply(console, a) } catch (e) { console.error(a.join("\n")) } else try { console.warn.apply(console, a) } catch (f) { console.warn(a.join("\n")) } } };

    window.orionLocalStorage = window.orionLocalStorage || {};

    var support = typeof localStorage !== "undefined" && typeof localStorage.setItem !== "undefined" && typeof localStorage.getItem !== "undefined";

    window.orionLocalStorage.setItem = function (key, value, expirationMinutes) {
        try {
            if (!support)
                return false;

            var dt = new Date();
            localStorage.setItem(key, value);

            if (!isNaN(parseInt(expirationMinutes))) {
                dt.setTime(dt.getTime() + (expirationMinutes * 60 * 1000));
                localStorage.setItem(key + "_expiration", dt.getTime());
            }
        }
        catch (e) {
            log(["Erro ao salvar os dados: ", e.message], "alerta");
        };
    };

    window.orionLocalStorage.getItem = function (key) {
        try {
            if (!support)
                return false;

            var dt = new Date();
            var expiration = parseInt((localStorage.getItem(key + "_expiration") || 0), 10) || 0;

            if (dt.getTime() > expiration) {
                if (localStorage.removeItem) {
                    localStorage.removeItem(key);
                    localStorage.removeItem(key + "_expiration");
                }
                return null;
            }

            return localStorage.getItem(key);
        }
        catch (e) {
            log(["Erro ao salvar os dados: ", e.message], "alerta");
        };
    };
})();