!function(){try{let t={init:()=>{t.getOrderForm(),t.applyAddProductInCart(),t.removeProductPBMinCart()},windowOnload:()=>{t.minicartApplyTagPBM()},ajaxStop:()=>{},getOrderForm:()=>{},applyAddProductInCart:()=>{$(".dag-storefront-btn-buybutton").on("click",function(t){t.preventDefault();t={id:$(this).attr("sku-id"),quantity:$(this).parent().parent().find(".block-buybutton.quantity input").val(),seller:"1"};$(".modal-addToCart").addClass("opening");let e=$(".modal-addToCart"),a=$(".modal-addToCart__image img"),o=$(".modal-addToCart__check");vtexjs.checkout.addToCart([t],null).done(function(t){setTimeout(function(){e.addClass("opening"),setTimeout(function(){a.addClass("animate"),setTimeout(function(){o.addClass("animate")},800)},500)},1e3),setTimeout(function(){e.removeClass("opening"),a.removeClass("animate"),o.removeClass("animate"),location.reload()},3500)})})},minicartApplyTagPBM:()=>{vtexjs.checkout.getOrderForm().done(function(i){if(null!=i.items&&0!=i.items.length&&localStorage.getItem("dagCurrentProductPBM")){let e=JSON.parse(localStorage.getItem("dagCurrentProductPBM")),t=i.items,r=t.find(t=>t.productId==e.id);if(r&&null!=r){let o=t.findIndex(t=>t.productId==e.id),n=null;if(null!=r.manualPrice){let t=$(".minicart__body").find(`.minicart__product-remove-btn[data-index="${o}"]`).closest(".minicart__product"),e=t.find(".minicart__product-price"),a=(t.find(".minicart__qtd-value").append($('<span class="pbm-minicart-info">Desconto aplicado</span>')),n=r.manualPrice/100,e.text("R$ "+n.toString().replace(".",",")),i.value/100);a="R$ "+a.toString().replace(".",","),$(".minicart__totalizers-cart").text(a),$(".minicart__totalizer-val").text(a)}}}})},removeProductPBMinCart:()=>{$(document).on("click",".minicart__product-remove-btn",function(t){t.preventDefault(),$(t.target).is(".minicart__product-remove-btn")&&localStorage.getItem("dagCurrentCart")&&(localStorage.removeItem("dagCurrentCart"),localStorage.removeItem("dagCurrentCart_expiration"),localStorage.removeItem("dagCurrentProductPBM"),localStorage.removeItem("dagCurrentProductPBM_expiration"),setTimeout(function(){window.location.reload()},500))})}};$(document).ready(t.init);$(window).load(function(){t.windowOnload()}),$(document).ajaxStop(t.ajaxStop)}catch(t){console.log("Erro na inst√¢ncia do [Minicartv2]: ",t)}}();