!function(){try{let r={init:()=>{r.applyAddProductInCart(),r.removeProductPBMinCart()},windowOnload:()=>{r.minicartApplyTagPBM()},ajaxStop:()=>{},applyAddProductInCart:()=>{$(".dag-storefront-btn-buybutton").on("click",function(t){t.preventDefault();t={id:$(this).attr("sku-id"),quantity:$(this).parent().parent().find(".block-buybutton.quantity input").val(),seller:"1"};$(".modal-addToCart").addClass("opening");let e=$(".modal-addToCart"),a=$(".modal-addToCart__image img"),o=$(".modal-addToCart__check");vtexjs.checkout.addToCart([t],null).done(function(t){setTimeout(function(){e.addClass("opening"),setTimeout(function(){a.addClass("animate"),setTimeout(function(){o.addClass("animate")},800)},500)},1e3),setTimeout(function(){e.removeClass("opening"),a.removeClass("animate"),o.removeClass("animate"),location.reload()},3500)})})},minicartApplyTagPBM:()=>{vtexjs.checkout.getOrderForm().then(function(n){if(null!=n.items&&0!=n.items.length&&localStorage.getItem("dagCurrentCart")){let o=[],t=JSON.parse(localStorage.getItem("dagCurrentCart"));n.items.forEach((e,a)=>{t.consultList.forEach(t=>{e.productId==t.id&&o.push({itemIndex:a,manualPrice:e.manualPrice/100})})}),$(".minicart__body .minicart__product-remove-btn").each(function(e){let a=$(this);o.forEach(t=>{t.itemIndex==e&&(a.addClass("pbm-product"),r.buildInfoInPbmProduct(a,t.manualPrice,n.value,e))})})}})},buildInfoInPbmProduct:(t,e,a,o)=>{let n=t.closest(".minicart__product");n.find(".minicart__product-remove-btn").remove(),n.append($(`<div class="minicart__prod-pbm-remove" data-index="${o}"></div>`));let r=n.find(".minicart__product-price"),i=(n.find(".minicart__qtd-value").append($('<span class="pbm-minicart-info">Desconto aplicado</span>')),r.text("R$ "+e.toString().replace(".",",")),a/100);i="R$ "+i.toString().replace(".",","),$(".minicart__totalizers-cart").text(i),$(".minicart__totalizer-val").text(i)},removeProductPBMinCart:()=>{$(document).on("click",".minicart__prod-pbm-remove",function(t){t.preventDefault(),$(t.target).is(".minicart__prod-pbm-remove")&&($(t.target).parent().remove(),vtexjs.checkout.getOrderForm().then(function(t){let o=[],e=JSON.parse(localStorage.getItem("dagCurrentCart"));return t.items.forEach(a=>{e.consultList.forEach((t,e)=>{a.productId==t.id&&o.push({index:e,quantity:0})})}),vtexjs.checkout.removeItems(o)}).done(function(t){localStorage.removeItem("dagCurrentCart"),localStorage.removeItem("dagCurrentCart_expiration"),localStorage.removeItem("dagCurrentProductPBM"),localStorage.removeItem("dagCurrentProductPBM_expiration"),setTimeout(function(){window.location.reload()},500)}))})}};$(document).ready(r.init);$(window).load(function(){r.windowOnload()}),$(document).ajaxStop(r.ajaxStop)}catch(t){console.log("Erro na inst√¢ncia do [Minicartv2]: ",t)}}();